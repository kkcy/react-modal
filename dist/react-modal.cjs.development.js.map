{"version":3,"file":"react-modal.cjs.development.js","sources":["../src/ModalContext.ts","../src/Backdrop.tsx","../src/AnimatedModalStack.tsx","../src/Modal.tsx","../src/ModalContent.tsx","../src/ModalFooter.tsx","../src/ModalTitle.tsx","../src/theme.ts"],"sourcesContent":["import React, { useContext } from 'react'\n\nexport interface ModalContextValue {\n  allowClose: boolean\n  skipAnimations?: boolean\n  isFullScreen?: boolean\n  onClose?: () => any\n}\n\nexport const ModalContext = React.createContext<ModalContextValue>({} as any)\n\nexport function useModal() {\n  return useContext(ModalContext)\n}\n","import React from 'react'\nimport { Box, BoxProps } from 'theme-ui'\nimport { motion, MotionProps } from 'framer-motion'\nimport { useModal } from './ModalContext'\n\nconst MotionBox = motion(Box)\n\nexport default function Backdrop(props: BoxProps & MotionProps) {\n  const { skipAnimations, isFullScreen } = useModal()\n\n  if (isFullScreen) {\n    return null\n  }\n\n  return (\n    <MotionBox\n      aria-hidden=\"true\"\n      variant=\"modals.backdrop\"\n      custom={{ skip: skipAnimations }}\n      variants={{\n        enter: {\n          opacity: 1,\n          transition: {\n            duration: 0.2,\n          },\n        },\n        exit: ({ skip } = {}) => {\n          if (skip) {\n            return {\n              transition: {\n                duration: 0.2,\n              },\n            }\n          }\n          return {\n            opacity: 0,\n            transition: {\n              duration: 0.2,\n            },\n          }\n        },\n      }}\n      animate=\"enter\"\n      initial={skipAnimations ? false : 'exit'}\n      exit=\"exit\"\n      {...(props as any)}\n    />\n  )\n}\n","import {\n  ModalStack,\n  ModalStackProps,\n  ModalStackValue,\n} from '@mattjennings/react-modal-stack'\nimport { AnimatePresence } from 'framer-motion'\nimport React, { useEffect, useState } from 'react'\nimport Backdrop from './Backdrop'\n\nexport default function AnimatedModalStack(props: ModalStackProps) {\n  return <ModalStack renderModals={AnimatedModals} {...props} />\n}\n\nfunction AnimatedModals({ stack, closeModal }: ModalStackValue) {\n  // Lags slightly behind the `stack` so that we can animate the dismissal of modals\n  const [displayedStack, setDisplayedStack] = useState(stack)\n  const [skipAnimations, setSkipAnimations] = useState(false)\n  const [isOpen, setOpen] = useState(false)\n\n  useEffect(() => {\n    // if we're opening the first modal\n    if (stack.length === 1 && displayedStack.length === 0) {\n      setOpen(true)\n      setDisplayedStack(stack)\n    } else {\n      // else we are adding or dismissing a modal\n\n      // if either the previous or current modal should skip animations\n      const skipAnimations =\n        stack?.[stack.length - 1]?.props?.skipAnimations ??\n        displayedStack?.[displayedStack.length - 1]?.props?.skipAnimations\n\n      if (skipAnimations) {\n        setDisplayedStack(stack)\n        setOpen(true)\n        setSkipAnimations(true)\n      } else {\n        setSkipAnimations(false)\n        setOpen(false)\n      }\n    }\n  }, [stack])\n\n  // after displayedStack has updated, check whether the current modal should skip animations\n  // (incase we transitioned from an animated modal to a skipped animation modal)\n  useEffect(() => {\n    setSkipAnimations(\n      displayedStack?.[displayedStack.length - 1]?.props?.skipAnimations\n    )\n  }, [displayedStack])\n\n  return (\n    <>\n      <AnimatePresence>{stack.length > 0 && <Backdrop />}</AnimatePresence>\n      {displayedStack.map((modal, index) => {\n        const open = index === displayedStack.length - 1 && isOpen\n\n        return (\n          <modal.component\n            key={index}\n            open={open}\n            Backdrop={null}\n            onClose={closeModal}\n            onAnimationComplete={() => {\n              // set open state for next modal\n              if (stack.length > 0) {\n                setOpen(true)\n              } else {\n                setOpen(false)\n              }\n\n              // update displayed stack\n              // setTimeout is a hack to prevent a warning about updating state\n              // in an unmounted component (I can't figure out why it happens, or why this fixes it)\n              setTimeout(() => setDisplayedStack(stack))\n\n              modal.props?.onAnimationComplete?.()\n            }}\n            skipAnimations={skipAnimations}\n            {...modal.props}\n          />\n        )\n      })}\n    </>\n  )\n}\n","import { useModals } from '@mattjennings/react-modal-stack'\n// @ts-ignore\nimport { useResponsiveValue } from '@theme-ui/match-media'\nimport { AnimatePresence, motion, Variant } from 'framer-motion'\nimport { ModalContextValue, ModalContext } from './ModalContext'\nimport React, { useMemo } from 'react'\n// @ts-ignore\nimport { TouchScrollable } from 'react-scrolllock'\nimport { Box, BoxProps } from 'theme-ui'\nimport Backdrop from './Backdrop'\n\nexport interface ModalProps extends Omit<BoxProps, 'children'> {\n  open?: boolean\n\n  /**\n   * Allow user to close modal\n   */\n  allowClose?: boolean\n\n  /**\n   * Closes modal when user clicks outside of the modal\n   */\n  closeOnOutsideClick?: boolean\n\n  onClose?: () => any\n\n  /**\n   * Width of the modal when not full screen\n   */\n  width?: string | number\n\n  /**\n   * Max width of the modal when not full screen\n   */\n  maxWidth?: string | number\n\n  /**\n   * At which breakpoint (and below) it should be fullscreen.\n   *\n   * Alternatively, true for always and false for never\n   */\n  fullScreen?: boolean | 'xs' | 'sm' | 'md' | 'lg'\n\n  /**\n   * Skips the enter and exit animations\n   */\n  skipAnimations?: boolean\n\n  /**\n   * The component to use as the backdrop behind the modals\n   */\n  Backdrop?: React.ComponentType<any>\n\n  children?: React.ReactNode | ((props: ModalContextValue) => React.ReactNode)\n\n  /**\n   * The framer-motion animation variants to use\n   */\n  animations?: {\n    fullScreen?: {\n      enter: Variant\n      exit: Variant\n    }\n    default?: {\n      enter: Variant\n      exit: Variant\n    }\n  }\n}\n\nconst MotionBox = motion(Box)\n\nexport default function Modal({\n  allowClose = true,\n  closeOnOutsideClick = true,\n  Backdrop: BackdropComponent = Backdrop,\n  children,\n  fullScreen = `xs`,\n  maxWidth,\n  onClose,\n  open,\n  skipAnimations = false,\n  sx,\n  variant = 'default',\n  width = `auto`,\n  animations,\n  ...props\n}: ModalProps) {\n  const { closeModal } = useModals()\n\n  const modalAnimations = useMemo(() => enhanceAnimations(animations), [\n    animations,\n  ])\n  const isFullScreen = useResponsiveValue(getBreakpoints(fullScreen))\n  const animation = useResponsiveValue([\n    isFullScreen ? modalAnimations.fullScreen : modalAnimations.default,\n    isFullScreen ? modalAnimations.fullScreen : modalAnimations.default,\n    modalAnimations.default,\n  ])\n\n  function handleClose() {\n    if (onClose) {\n      onClose()\n    } else if (closeModal) {\n      closeModal()\n    }\n  }\n\n  const contextValue = useMemo<ModalContextValue>(\n    () => ({\n      allowClose,\n      onClose,\n      skipAnimations,\n      isFullScreen,\n    }),\n    [allowClose, onClose, skipAnimations, isFullScreen]\n  )\n\n  return (\n    <ModalContext.Provider value={contextValue}>\n      <AnimatePresence custom={{ skip: skipAnimations }}>\n        {open && (\n          <TouchScrollable>\n            <Box\n              sx={{\n                zIndex: `modal`,\n                position: `fixed`,\n                top: 0,\n                left: 0,\n                right: 0,\n                bottom: 0,\n                display: `flex`,\n                justifyContent: `center`,\n              }}\n              onClick={closeOnOutsideClick ? handleClose : undefined}\n            >\n              {BackdropComponent && <BackdropComponent />}\n              <MotionBox\n                aria-modal=\"true\"\n                variants={animation}\n                animate=\"enter\"\n                exit=\"exit\"\n                initial={skipAnimations ? false : 'exit'}\n                variant={\n                  isFullScreen\n                    ? `modals.${variant}FullScreen`\n                    : `modals.${variant}`\n                }\n                sx={{\n                  width: isFullScreen ? null : width,\n                  maxWidth: isFullScreen ? null : maxWidth,\n                  ...(sx ?? {}),\n                }}\n                onClick={(ev: Event) => ev.stopPropagation()}\n                {...(props as any)}\n              >\n                {typeof children === `function`\n                  ? children(contextValue)\n                  : children}\n              </MotionBox>\n            </Box>\n          </TouchScrollable>\n        )}\n      </AnimatePresence>\n    </ModalContext.Provider>\n  )\n}\n\nfunction enhanceAnimations(animations: ModalProps['animations']) {\n  const defaultAnimations: Record<string, Record<string, Variant>> = {\n    default: {\n      enter: {\n        opacity: 1,\n        scale: 1,\n        transition: {\n          duration: 0.2,\n          ease: `easeInOut`,\n        },\n      },\n      exit: {\n        opacity: 0,\n        scale: 0.75,\n        transition: {\n          duration: 0.2,\n          ease: `easeInOut`,\n        },\n      },\n    },\n    fullScreen: {\n      enter: {\n        opacity: 1,\n        y: 0,\n        transition: {\n          ease: `easeInOut`,\n        },\n      },\n      exit: {\n        opacity: 0,\n        y: `100vh`,\n        transition: {\n          ease: `easeInOut`,\n        },\n      },\n    },\n  }\n\n  return {\n    fullScreen: animations?.fullScreen\n      ? {\n          enter: animations.fullScreen.enter,\n          exit: (custom: { skip?: boolean } = {}) => {\n            if (custom.skip) {\n              return {\n                transition: {\n                  duration: 0,\n                },\n              }\n            }\n\n            return typeof animations?.fullScreen?.exit === 'function'\n              ? //@ts-ignore\n                animations.fullScreen?.exit(custom)\n              : animations.fullScreen?.exit\n          },\n        }\n      : defaultAnimations.fullScreen,\n    default: animations?.default\n      ? {\n          enter: animations.default.enter,\n          exit: (custom: { skip?: boolean } = {}) => {\n            if (custom.skip) {\n              return {\n                transition: {\n                  duration: 0,\n                },\n              }\n            }\n\n            return typeof animations?.default?.exit === 'function'\n              ? //@ts-ignore\n                animations.default?.exit(custom)\n              : animations.default?.exit\n          },\n        }\n      : defaultAnimations.default,\n  }\n}\n\nfunction getBreakpoints(value: boolean | 'xs' | 'sm' | 'md' | 'lg') {\n  switch (value) {\n    case true:\n      return [true, true, true, true, true, true]\n    case false:\n      return [false, false, false, false, false]\n    case `xs`:\n      return [true, false, false, false, false]\n    case `sm`:\n      return [true, true, false, false, false]\n    case `md`:\n      return [true, true, true, false, false]\n    case `lg`:\n      return [true, true, true, true, false]\n  }\n}\n","import React from 'react'\nimport { Box, BoxProps } from 'theme-ui'\n\nconst ModalContent = React.forwardRef<HTMLDivElement, BoxProps>(\n  function ModalContent(props, ref) {\n    return <Box variant=\"modals.content\" {...props} ref={ref} />\n  }\n)\n\nexport default ModalContent\n","import React from 'react'\nimport { Box, BoxProps } from 'theme-ui'\n\nconst ModalFooter = React.forwardRef<HTMLDivElement, BoxProps>(\n  function ModalFooter(props, ref) {\n    return <Box variant=\"modals.footer\" {...props} ref={ref} />\n  }\n)\n\nexport default ModalFooter\n","import React from 'react'\nimport { Box, BoxProps, Close } from 'theme-ui'\nimport { useModal } from './ModalContext'\n\nexport interface ModalTitleProps extends BoxProps {\n  CloseButton?: React.ComponentType<{ onClick: () => any }>\n}\n\nconst ModalTitle = React.forwardRef<HTMLDivElement, ModalTitleProps>(\n  function ModalTitle({ children, CloseButton, ...props }, ref) {\n    const { allowClose, onClose } = useModal()\n\n    return (\n      <Box variant=\"modals.title\" {...props} ref={ref}>\n        {children}\n        {allowClose &&\n          (CloseButton ? (\n            <CloseButton onClick={onClose as any} />\n          ) : (\n            <Close\n              sx={{\n                height: 6,\n                width: 6,\n                '&:hover': {\n                  cursor: 'pointer',\n                },\n              }}\n              onClick={onClose}\n            />\n          ))}\n      </Box>\n    )\n  }\n)\n\nexport default ModalTitle\n","import { Theme } from 'theme-ui'\n\nexport const modalTheme = {\n  modals: {\n    // Modal components\n    backdrop: {\n      zIndex: `backdrop`,\n      position: `fixed`,\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      background: `rgba(0,0,0,0.3)`,\n    },\n    content: {\n      px: '1rem',\n      flexGrow: 1,\n      overflowY: 'scroll',\n    },\n    footer: {\n      minHeight: 16,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'flex-end',\n      px: '1rem',\n    },\n    title: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      minHeight: 16,\n      px: '1rem',\n    },\n\n    // Modal variants\n    default: {\n      backgroundColor: 'background',\n      borderRadius: 'lg',\n      boxShadow: `md`,\n      display: `flex`,\n      flexDirection: `column`,\n      maxHeight: `80vh`,\n      minHeight: '16rem',\n      minWidth: '16rem',\n      maxWidth: 'min(90vw, 64rem)',\n      position: `absolute`,\n      top: [`25%`, `10%`, `10%`],\n      zIndex: `modal`,\n    },\n    defaultFullScreen: {\n      backgroundColor: 'background',\n      borderRadius: 0,\n      display: `flex`,\n      flexDirection: `column`,\n      minHeight: '100vh',\n      maxHeight: '100vh',\n      height: `fill-available`,\n      position: `absolute`,\n      top: 0,\n      width: `100vw`,\n      zIndex: `modal`,\n    },\n  },\n  zIndices: {\n    backdrop: 100,\n    modal: 110,\n  },\n}\n\nexport function withModalTheme<T extends Theme>(theme: T) {\n  return {\n    ...theme,\n    modals: { ...modalTheme.modals, ...((theme as any)?.modals ?? {}) },\n    zIndices: {\n      ...modalTheme.zIndices,\n      ...(theme?.zIndices ?? []),\n    },\n  }\n}\n"],"names":["ModalContext","React","createContext","useModal","useContext","MotionBox","motion","Box","Backdrop","props","skipAnimations","isFullScreen","variant","custom","skip","variants","enter","opacity","transition","duration","exit","animate","initial","AnimatedModalStack","ModalStack","renderModals","AnimatedModals","stack","closeModal","useState","displayedStack","setDisplayedStack","setSkipAnimations","isOpen","setOpen","useEffect","length","AnimatePresence","map","modal","index","open","component","key","onClose","onAnimationComplete","setTimeout","Modal","allowClose","closeOnOutsideClick","BackdropComponent","children","fullScreen","maxWidth","sx","width","animations","useModals","modalAnimations","useMemo","enhanceAnimations","useResponsiveValue","getBreakpoints","animation","handleClose","contextValue","Provider","value","TouchScrollable","zIndex","position","top","left","right","bottom","display","justifyContent","onClick","undefined","ev","stopPropagation","defaultAnimations","scale","ease","y","ModalContent","forwardRef","ref","ModalFooter","ModalTitle","CloseButton","Close","height","cursor","modalTheme","modals","backdrop","background","content","px","flexGrow","overflowY","footer","minHeight","alignItems","title","backgroundColor","borderRadius","boxShadow","flexDirection","maxHeight","minWidth","defaultFullScreen","zIndices","withModalTheme","theme"],"mappings":"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"}